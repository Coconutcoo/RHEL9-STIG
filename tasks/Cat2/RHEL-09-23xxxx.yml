---

- name: "MEDIUM | RHEL-09-231010 | PATCH | A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent)."
  when:
    - rhel_09_231010
    - ansible_facts['mounts']| selectattr('mount', '==', rhel9stig_home_filesystem)
  tags:
    - RHEL-09-231010
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257843r925516_rule
    - V-257843
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231010"
  block:
    - name: "MEDIUM | RHEL-09-231010 | PATCH | A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent)."
      ansible.builtin.debug:
        msg: "Warning!! The designated /home directory is not a seperate filesystem"

    - name: "MEDIUM | RHEL-09-231010 | PATCH | A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent)."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231015 | PATCH | RHEL 9 must use a separate file system for /tmp."
  when:
    - rhel_09_231015
    - ansible_facts['mounts']| selectattr('mount', '==', '/tmp')
  tags:
    - RHEL-09-231015
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257844r925519_rule
    - V-257844
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231015"
  block:
    - name: "MEDIUM | RHEL-09-231015 | PATCH | RHEL 9 must use a separate file system for /tmp.."
      ansible.builtin.debug:
        msg: "Warning!! /tmp directory is not a seperate filesystem"

    - name: "MEDIUM | RHEL-09-231015 | PATCH | RHEL 9 must use a separate file system for /tmp."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231035 | PATCH | RHEL 9 must use a separate file system for /var/tmp."
  when:
    - rhel_09_231035
    - ansible_facts['mounts']| selectattr('mount', '==', '/var/tmp')
  tags:
    - RHEL-09-231035
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257848r925531_rule
    - V-257848
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231035"
  block:
    - name: "MEDIUM | RHEL-09-231035 | PATCH | RHEL 9 must use a separate file system for /var/tmp."
      ansible.builtin.debug:
        msg: "Warning!! /var/tmp directory is not a seperate filesystem"

    - name: "MEDIUM | RHEL-09-231035 | PATCH | RHEL 9 must use a separate file system for /var/tmp."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231040 | PATCH | RHEL 9 file system automount function must be disabled unless required."
  when:
    - rhel_09_231040
  tags:
    - RHEL-09-231040
    - CAT2
    - CCI-000366
    - CCI-000778
    - CCI-001958
    - SRG-OS-000114-GPOS-00059
    - SRG-OS-000378-GPOS-00163
    - SRG-OS-000480-GPOS-00227
    - SV-257849r925534_rule
    - V-257849
    - NIST800-53R4_CM-6
    - NIST800-53R4_IA-3
  ansible.builtin.systemd:
    daemon_reload: true
    masked: true
    name: autofs.service

- name: "MEDIUM | RHEL-09-231045 | PATCH | RHEL 9 must prevent device files from being interpreted on file systems that contain user home directories."
  when:
    - rhel_09_231045
    - (item.mount == rhel9stig_home_filesystem and "'nodev' not in item.options")
  notify:
    - Remount_home
  tags:
    - RHEL-09-231045
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257850r925537_rule
    - V-257850
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }},nodev"
    path: "{{ rhel9stig_home_filesystem }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231050 | PATCH | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that contain user home directories."
  when:
    - rhel_09_231050
    - (item.mount == rhel9stig_home_filesystem and "'nosuid' not in item.options")
  notify:
    - Remount_home
  tags:
    - RHEL-09-231050
    - CAT2
    - CCI-000366
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SRG-OS-000480-GPOS-00227
    - SV-257851r925540_rule
    - V-257851
    - NIST800-53R4_CM-6
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }}{% if rhel_09_231045 %},nodev{% endif %},nosuid"
    path: "{{ rhel9stig_home_filesystem }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231055 | PATCH | RHEL 9 must prevent code from being executed on file systems that contain user home directories."
  when:
    - rhel_09_231055
    - (item.mount == rhel9stig_home_filesystem and "'noexec' not in item.options")
  notify:
    - Remount_home
  tags:
    - RHEL-09-231055
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257852r925543_rule
    - V-257852
    - NIST800-53R4_CM-6
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }}{% if rhel_09_231045 %},nodev{% endif %}{% if rhel_09_231050 %},nosuid{% endif %},noexec"
    path: "{{ rhel9stig_home_filesystem }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231060 | PATCH | RHEL 9 must be configured so that the Network File System (NFS) is configured to use RPCSEC_GSS."
  when:
    - rhel_09_231060
    - ansible_facts['mounts']| selectattr('fstype', '==', 'nfs')
    - "'nfs-utils' in ansible_facts.packages"
    - rhel9stig_disruption_high
  tags:
    - RHEL-09-231060
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257853r925546_rule
    - V-257853
    - NIST800-53R4_CM-6
  ansible.posix.mount:
    fstype: "nfs"
    opts: "sec=krb5p:krb5i:krb5"
    path: "{{ item.mount }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231065 | PATCH | RHEL 9 must prevent special devices on file systems that are imported via Network File System (NFS)."
  when:
    - rhel_09_231065
    - ansible_facts['mounts']| selectattr('fstype', '==', 'nfs')
    - "'nfs-utils' in ansible_facts.packages"
    - "'nodev' not in item.options"
    - rhel9stig_disruption_high
  tags:
    - RHEL-09-231065
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257854r925549_rule
    - V-257854
    - NIST800-53R4_CM-6
  ansible.posix.mount:
    fstype: "nfs"
    opts: "{{ item.options }},nodev"
    path: "{{ item.mount }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231070 | PATCH | RHEL 9  must prevent code from being executed on file systems that are imported via Network File System (NFS)."
  when:
    - rhel_09_231070
    - ansible_facts['mounts']| selectattr('fstype', '==', 'nfs')
    - "'nfs-utils' in ansible_facts.packages"
    - "'noexec' not in item.options"
    - rhel9stig_disruption_high
  tags:
    - RHEL-09-231070
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257855r925552_rule
    - V-257855
    - NIST800-53R4_CM-6
  ansible.posix.mount:
    fstype: "nfs"
    opts: "{{ item.options }}{% if rhel_09_231065 %},nodev{% endif%},noexec"
    path: "{{ item.mount }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231075 | PATCH | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are imported via Network File System (NFS)."
  when:
    - rhel_09_231075
    - ansible_facts['mounts']| selectattr('fstype', '==', 'nfs')
    - "'nfs-utils' in ansible_facts.packages"
    - "'nosuid' not in item.options"
    - rhel9stig_disruption_high
  tags:
    - RHEL-09-231075
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257856r925555_rule
    - V-257856
    - NIST800-53R4_CM-6
  ansible.posix.mount:
    fstype: "nfs"
    opts: "{{ item.options }}{% if rhel_09_231065 %},nodev{% endif%}{% if rhel_09_231070 %},noexec{% endif%},nosuid"
    path: "{{ item.mount }}"
    src: "{{ item.device }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231080 | WARN | RHEL 9 must prevent code from being executed on file systems that are used with removable media."
  when:
    - rhel_09_231080
    - rhel9stig_discovered_removable_storage is defined
  tags:
    - RHEL-09-231080
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257857r925558_rule
    - V-257857
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231080"
  block:
    - name: "MEDIUM | RHEL-09-231080 | WARN | RHEL 9 must prevent code from being executed on file systems that are used with removable media."
      ansible.builtin.debug:
        msg: "Warning!! You have removable devices attached manually check noexec is set in mount options :- device IDs:{{ rhel9stig_discovered_removable_storage}}"

    - name: "MEDIUM | RHEL-09-231080 | WARN | RHEL 9 must prevent code from being executed on file systems that are used with removable media."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231085 | WARN | RHEL 9 must prevent special devices on file systems that are used with removable media."
  when:
    - rhel_09_231080
    - rhel9stig_discovered_removable_storage is defined
  tags:
    - RHEL-09-231085
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257858r925561_rule
    - V-257858
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231085"
  block:
    - name: "MEDIUM | RHEL-09-231085 | WARN | RHEL 9 must prevent special devices on file systems that are used with removable media."
      ansible.builtin.debug:
        msg: "Warning!! You have removable devices attached, manually check nodev is set in mount options :- device IDs:{{ rhel9stig_discovered_removable_storage}}"

    - name: "MEDIUM | RHEL-09-231085 | WARN | RHEL 9 must prevent special devices on file systems that are used with removable media."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231090 | WARN | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are used with removable media."
  when:
    - rhel_09_231090
    - rhel9stig_discovered_removable_storage is defined
  tags:
    - RHEL-09-231090
    - CAT2
    - CCI-000366
    - SRG-OS-000480-GPOS-00227
    - SV-257859r925564_rule
    - V-257859
    - NIST800-53R4_CM-6
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231090"
  block:
    - name: "MEDIUM | RHEL-09-231090 | WARN | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are used with removable media."
      ansible.builtin.debug:
        msg: "Warning!! You have removable devices attached, manually check nosuid is set in mount options :- device IDs:{{ rhel9stig_discovered_removable_storage}}"

    - name: "MEDIUM | RHEL-09-231090 | WARN | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are used with removable media."
      ansible.builtin.import_tasks: warning_facts.yml

- name: "MEDIUM | RHEL-09-231095 | PATCH | RHEL 9 must mount /boot with the nodev option. | BIOS based OS"
  when:
    - rhel_09_231095
    - rhel9stig_legacy_boot
    - (item.mount == '/boot' and "'nodev' not in item.options")
  notify:
    - Change_requires_reboot
  tags:
    - RHEL-09-231095
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257860r925567_rule
    - V-257860
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }},nodev"
    path: '/boot'
    src: "UUID={{ item.uuid }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231100 | PATCH | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot directory. | BIOS based OS"
  when:
    - rhel_09_231100
    - rhel9cis_legacy_boot
    - (item.mount == '/boot' and "'nosuid' not in item.options")
  notify:
    - Change_requires_reboot
  tags:
    - RHEL-09-231100
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257861r925570_rule
    - V-257861
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }}{% if rhel_09_231100 %},nodev{% endif %},nosuid"
    path: '/boot'
    src: "UUID={{ item.uuid }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231105 | PATCH | RHEL 9 must prevent files with the setuid and setgid bit set from being executed on the /boot/efi directory. | UEFI based OS"
  when:
    - rhel_09_231105
    - not rhel9stig_legacy_boot
    - (item.mount == '/boot/efi' and "'nosuid' not in item.options")
  notify:
    - Change_requires_reboot
  tags:
    - RHEL-09-231105
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257862r925573_rule
    - V-257862
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }},nosuid"
    path: '/boot/efi'
    src: "UUID={{ item.uuid }}"
    state: present
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231110 | PATCH | RHEL 9 must mount /dev/shm with the nodev option."
  when:
    - rhel_09_231110 or rhel_09_231115 or rhel_09_231120
  notify:
    - Change_requires_reboot
  tags:
    - RHEL-09-231110
    - RHEL-09-231115
    - RHEL-09-231120
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257864r925576_rule
    - SV-257865r925579_rule
    - SV-257866r925582_rule
    - V-257863
    - V-257864
    - V-257865
    - NIST800-53R4_CM-7
  vars:
    warn_control_id: "MEDIUM | RHEL-09-231110-231120"
  block:
    - name: |
        "MEDIUM | RHEL-09-231110 | AUDIT | RHEL 9 must mount /dev/shm with the nodev option.
         MEDIUM | RHEL-09-231115 | AUDIT | RHEL 9 must mount /dev/shm with the noexec option.
         MEDIUM | RHEL-09-231120 | AUDIT | RHEL 9 must mount /dev/shm with the nosuid option."
      ansible.builtin.shell: mount | grep /dev/shm
      changed_when: false
      failed_when: false
      register: rhel9stig_231110_dev_shm_status

    - name: |
        "MEDIUM | RHEL-09-231110 | PATCH | RHEL 9 must mount /dev/shm with the nodev option.
         MEDIUM | RHEL-09-231115 | PATCH | RHEL 9 must mount /dev/shm with the noexec option.
         MEDIUM | RHEL-09-231120 | PATCH | RHEL 9 must mount /dev/shm with the nosuid option."
      when: rhel9stig_231110_dev_shm_status.stdout | length > 0
      ansible.posix.mount:
        fstype: tmpfs
        opts: "defaults{{ rhel_09_231110 | ternary (',nodev', '') }}{{ rhel_09_231115 | ternary (',noexec', '') }}{{ rhel_09_231120 | ternary (',nosuid', '') }}"
        path: /dev/shm
        state: mounted
        src: tmpfs

    - name: |
        "MEDIUM | RHEL-09-231110 | WARN | RHEL 9 must mount /dev/shm with the nodev option.
         MEDIUM | RHEL-09-231115 | WARN | RHEL 9 must mount /dev/shm with the noexec option.
         MEDIUM | RHEL-09-231120 | WARN | RHEL 9 must mount /dev/shm with the nosuid option."
      when: rhel9stig_231110_dev_shm_status.stdout | length == 0
      ansible.builtin.debug:
        msg: "Warning!! You have no /dev/shm mount"

    - name: |
        "MEDIUM | RHEL-09-231110 | WARN | RHEL 9 must mount /dev/shm with the nodev option.
         MEDIUM | RHEL-09-231115 | WARN | RHEL 9 must mount /dev/shm with the noexec option.
         MEDIUM | RHEL-09-231120 | WARN | RHEL 9 must mount /dev/shm with the nosuid option."
      when: rhel9stig_231110_dev_shm_status.stdout | length == 0
      ansible.builtin.import_tasks: warning_facts.yml

- name: |
    "MEDIUM | RHEL-09-231125 | PATCH | RHEL 9 must mount /tmp with the nodev option.
    MEDIUM | RHEL-09-231130 | PATCH | RHEL 9 must mount /tmp with the noexec option.
    MEDIUM | RHEL-09-231135 | PATCH | RHEL 9 must mount /tmp with the nosuid option."
  when:
    - rhel_09_231125 or rhel_09_231130 or rhel_09_231135
    - item.mount == '/tmp'
  notify:
    - Remount_tmp
  tags:
    - RHEL-09-231125
    - RHEL-09-231130
    - RHEL-09-231135
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257866r925585_rule
    - SV-257866r925588_rule
    - SV-257866r925591_rule
    - V-257866
    - V-257867
    - V-257868
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "defaults{{ rhel_09_231125 | ternary (',nodev', '') }}{{ rhel_09_231130 | ternary (',noexec', '') }}{{ rhel_09_231135 | ternary (',nosuid', '') }}"
    path: /tmp
    state: present
    src: "{{ item.device }}"
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: "MEDIUM | RHEL-09-231140 | PATCH | RHEL 9 must mount /var with the nodev option."
  when:
    - rhel_09_231140
    - item.mount == '/var'
    - "'nodev' not in item.options"
  notify:
    - Remount_tmp
  tags:
    - RHEL-09-231140
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257869r925594_rule
    - V-257869
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "{{ item.options }},nodev"
    path: /var
    state: present
    src: "{{ item.device }}"
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: |
    "MEDIUM | RHEL-09-231145 | PATCH | RHEL 9 must mount /var/log with the nodev option.
    MEDIUM | RHEL-09-231150 | PATCH | RHEL 9 must mount /var/log with the noexec option.
    MEDIUM | RHEL-09-231155 | PATCH | RHEL 9 must mount /var/log with the nosuid option."
  when:
    - rhel_09_231145
    - rhel_09_231150
    - rhel_09_231155
    - item.mount == '/var/log'
  notify:
    - Systemd_daemon_reload
    - Change_requires_reboot
  tags:
    - RHEL-09-231145
    - RHEL-09-231150
    - RHEL-09-231155
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257870r925597_rule
    - SV-257871r925600_rule
    - SV-257872r925603_rule
    - V-257870
    - V-257871
    - V-257872
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "defaults{{ rhel_09_231150 |ternary (',nodev', '') }}{{ rhel_09_231150 | ternary (',noexec', '') }}{{ rhel_09_231155 | ternary (',nosuid', '') }}"
    path: /var/log
    state: present
    src: "{{ item.device }}"
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: |
    "MEDIUM | RHEL-09-231160 | PATCH | RHEL 9 must mount /var/log/audit with the nodev option.
    MEDIUM | RHEL-09-231165 | PATCH | RHEL 9 must mount /var/log/audit with the noexec option.
    MEDIUM | RHEL-09-231170 | PATCH | RHEL 9 must mount /var/log/audit with the noexec option."
  when:
    - rhel_09_231160
    - rhel_09_231165
    - rhel_09_231170
    - item.mount == '/var/log/audit'
  notify:
    - Change_requires_reboot
  tags:
    - RHEL-09-231160
    - RHEL-09-231165
    - RHEL-09-231170
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257873r925606_rule
    - SV-257874r925609_rule
    - SV-257875r925612_rule
    - V-257873
    - V-257874
    - V-257875
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "defaults{{ rhel_09_231160 | ternary (',nodev', '') }}{{ rhel_09_231165 | ternary (',noexec', '') }}{{ rhel_09_231170 | ternary (',nosuid', '') }}"
    path: /var/log/audit
    state: present
    src: "{{ item.device }}"
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"

- name: |
    "MEDIUM | RHEL-09-231175 | PATCH | RHEL 9 must mount /var/tmp with the nodev option.
    MEDIUM | RHEL-09-231180 | PATCH | RHEL 9 must mount /var/tmp with the noexec option.
    MEDIUM | RHEL-09-231185 | PATCH | RHEL 9 must mount /var/tmp with the noexec option."
  when:
    - rhel_09_231175
    - rhel_09_231180
    - rhel_09_231185
    - item.mount == '/var/tmp'
  notify:
    - Remount_var_tmp
  tags:
    - RHEL-09-231175
    - RHEL-09-231180
    - RHEL-09-231185
    - CAT2
    - CCI-001764
    - SRG-OS-000368-GPOS-00154
    - SV-257873r925615_rule
    - SV-257874r925618_rule
    - SV-257875r925621_rule
    - V-257876
    - V-257877
    - V-257878
    - NIST800-53R4_CM-7
  ansible.posix.mount:
    fstype: "{{ item.fstype }}"
    opts: "defaults{{ rhel_09_231175 | ternary (',nodev', '') }}{{ rhel_09_231180 | ternary (',noexec', '') }}{{ rhel_09_231185 | ternary (',nosuid', '') }}"
    path: /var/tmp
    state: present
    src: "{{ item.device }}"
  loop: "{{ ansible_facts.mounts }}"
  loop_control:
    label: "{{ item.device }}"
