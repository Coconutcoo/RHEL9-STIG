---

## metadata for Audit benchmark
benchmark_version: 'v1r1'

## Benchmark name used by audting control role
# The audit variable found at the base
benchmark: RHEL9-STIG

# Whether to skip the OS check for supported OS's
skip_os_check: false

rhel9stig_cat1_patch: true
rhel9stig_cat2_patch: true
rhel9stig_cat3_patch: true

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
rhel9stig_complexity_high: false

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
rhel9stig_audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
rhel9stig_disruption_high: false

# tweak role to run in a chroot, such as in kickstart %post script
rhel9stig_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

# tweak role to run in a non-privileged container (default value)- dynamically discovered in tasks/main.yml
system_is_container: false

# Place to find the container yml file for your environment - /vars/...
container_vars_file: is_container.yml

# rhel8cis/stig is left off the front of this var for consistency in testing pipeline
# system_is_ec2 toggle will disable tasks that fail on Amazon EC2 instances. Set true to skip and false to run tasks
system_is_ec2: false

# Whether to skip the reboot
rhel9stig_skip_reboot: true

# Defined will change if control requires
change_requires_reboot: false

rhel9stig_workaround_for_disa_benchmark: true
rhel9stig_workaround_for_ssg_benchmark: true

### Goss is required on the remote host ###
## Refer to vars/auditd.yml for any other settings ##

setup_audit: false
# How to retrieve audit binary
# Options are copy or download - detailed settings at the bottom of this file
# you will need to access to either github or the file already dowmloaded
get_audit_binary_method: download

# how to get audit files onto host options
# options are git/copy/get_url other e.g. if you wish to run from already downloaded conf
audit_content: git

# enable audits to run - this  runs the audit and get the latest content
run_audit: false

# Run heavy tests - some tests can have more impact on a system enabling these can have greater impact on a system
audit_run_heavy_tests: true

### End Goss enablements ####

#### CAT 1
rhel_09_211010: true
rhel_09_211045: true
rhel_09_211050: true
rhel_09_212020: true
rhel_09_214015: true
rhel_09_214020: true
rhel_09_214025: true
rhel_09_215015: true
rhel_09_215060: true
rhel_09_231190: true
rhel_09_252070: true
rhel_09_252075: true
rhel_09_255040: true
rhel_09_255050: true
rhel_09_271040: true
rhel_09_411100: true
rhel_09_431010: true
rhel_09_611025: true
rhel_09_671010: true
rhel_09_672015: true
rhel_09_672030: true

# Cat2

rhel_09_211015: true
rhel_09_211020: true
rhel_09_211025: true
rhel_09_211030: true
rhel_09_211040: true
rhel_09_211055: true
rhel_09_212010: true
rhel_09_212015: true
rhel_09_212025: true
rhel_09_212030: true
rhel_09_212035: true
rhel_09_212040: true
rhel_09_212045: true
rhel_09_213010: true
rhel_09_213015: true
rhel_09_213020: true
rhel_09_213025: true
rhel_09_213030: true
rhel_09_213035: true
rhel_09_213040: true
rhel_09_213045: true
rhel_09_213050: true
rhel_09_213055: true
rhel_09_213060: true
rhel_09_213065: true
rhel_09_213070: true
rhel_09_213075: true
rhel_09_213080: true
rhel_09_213085: true
rhel_09_213090: true
rhel_09_213095: true
rhel_09_213100: true
rhel_09_213105: true
rhel_09_213110: true
rhel_09_213115: true
rhel_09_214010: true
rhel_09_214030: true

## SSHD
rhel9stig_sshd_config_file: /etc/ssh/sshd_config
rhel9stig_ssh_required: true

## Grub
rhel9stig_grub_superuser: root
rhel9stig_bootloader_password_hash: 'grub.pbkdf2.sha512.changethispassword'  # pragma: allowlist secret
rhel9stig_set_bootloader_password: false

## Banner
rhel9stig_logon_banner: "{{ rhel9stig_workaround_for_disa_benchmark | ternary(
        rhel9stig_logon_banner_nice | regex_replace('(?s)(?<!\\n)\\n(?!(\n|$))', ' '),
        rhel9stig_logon_banner_nice) }}"
rhel9stig_logon_banner_nice: |
    You are accessing a U.S. Government (USG) Information System (IS) that is
    provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you consent
    to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
    purposes including, but not limited to, penetration testing, COMSEC monitoring,
    network operations and defense, personnel misconduct (PM), law enforcement
    (LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are subject
    to routine monitoring, interception, and search, and may be disclosed or used
    for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access controls)
    to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to PM, LE
    or CI investigative searching or monitoring of the content of privileged
    communications, or work product, related to personal representation or services
    by attorneys, psychotherapists, or clergy, and their assistants. Such
    communications and work product are private and confidential. See User
    Agreement for details.

# Threat Protection
rhel9stig_av_pkg: 'mcafeetp'
rhel9stig_av_service: 'mfetpd'

# Packages and services
rhel9stig_is_ftp_server: false
rhel9stig_is_tftp_server: false

# Sysctl file
rhel9stig_sysctl_file: /etc/sysctl.d/99-sysctl.conf
