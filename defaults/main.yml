---

## metadata for Audit benchmark
benchmark_version: '1.1.0'

## Benchmark name used by audting control role
# The audit variable found at the base
benchmark: RHEL9-STIG

# Whether to skip the OS check for supported OS's
skip_os_check: false

rhel9stig_cat1: true
rhel9stig_cat2: true
rhel9stig_cat3: true

# We've defined complexity-high to mean that we cannot automatically remediate
# the rule in question.  In the future this might mean that the remediation
# may fail in some cases.
rhel9stig_complexity_high: false

# Show "changed" for complex items not remediated per complexity-high setting
# to make them stand out.  "changed" items on a second run of the role would
# indicate items requiring manual review.
rhel9stig_audit_complex: true

# We've defined disruption-high to indicate items that are likely to cause
# disruption in a normal workflow.  These items can be remediated automatically
# but are disabled by default to avoid disruption.
rhel9stig_disruption_high: false

# tweak role to run in a chroot, such as in kickstart %post script
rhel9stig_system_is_chroot: "{{ ansible_is_chroot | default(False) }}"

# Set if system uses ipv6
rhel9stig_system_uses_ipv6: false

# Place to find the container yml file for your environment - /vars/...
container_vars_file: is_container.yml

# rhel8cis/stig is left off the front of this var for consistency in testing pipeline
# system_is_ec2 toggle will disable tasks that fail on Amazon EC2 instances. Set true to skip and false to run tasks
system_is_ec2: false

# Whether to skip the reboot
rhel9stig_skip_reboot: true

# Defined will change if control requires
change_requires_reboot: false

rhel9stig_workaround_for_disa_benchmark: true
rhel9stig_workaround_for_ssg_benchmark: true

# system acts or requires router networking options
rhel9stig_system_is_router: false

##########################################
### Goss is required on the remote host ###
## Refer to vars/auditd.yml for any other settings ##

# Allow audit to setup the requirements including installing git (if option chosen and downloading and adding goss binary to system)
setup_audit: false

# enable audits to run - this runs the audit and get the latest content
run_audit: false

# Only run Audit do not remediate
audit_only: false
# As part of audit_only
# This will enable files to be copied back to control node
fetch_audit_files: false
# Path to copy the files to will create dir structure
audit_capture_files_dir: /some/location to copy to on control node

# How to retrieve audit binary
# Options are copy or download - detailed settings at the bottom of this file
# you will need to access to either github or the file already dowmloaded
get_audit_binary_method: download

# how to get audit files onto host options
# options are git/copy/get_url other e.g. if you wish to run from already downloaded conf
audit_content: git

# Run heavy tests - some tests can have more impact on a system enabling these can have greater impact on a system
audit_run_heavy_tests: true

# This variable specifies the timeout (in ms) for audit commands that
# take a very long time: if a command takes too long to complete,
# it will be forcefully terminated after the specified duration.
audit_cmd_timeout: 120000

### End Goss enablements ####

#### CAT 1
rhel_09_211010: true
rhel_09_211045: true
rhel_09_211050: true
rhel_09_212020: true
rhel_09_214015: true
rhel_09_214020: true
rhel_09_214025: true
rhel_09_215015: true
rhel_09_215060: true
rhel_09_231190: true
rhel_09_252070: true
rhel_09_252075: true
rhel_09_255040: true
rhel_09_255050: true
rhel_09_271040: true
rhel_09_411100: true
rhel_09_431010: true
rhel_09_611025: true
rhel_09_671010: true
rhel_09_672015: true
rhel_09_672030: true

# Cat2

rhel_09_211015: true
rhel_09_211020: true
rhel_09_211025: true
rhel_09_211030: true
rhel_09_211040: true
rhel_09_211055: true
rhel_09_212010: true
rhel_09_212015: true
rhel_09_212025: true
rhel_09_212030: true
rhel_09_212035: true
rhel_09_212040: true
rhel_09_212045: true
rhel_09_213010: true
rhel_09_213015: true
rhel_09_213020: true
rhel_09_213025: true
rhel_09_213030: true
rhel_09_213035: true
rhel_09_213040: true
rhel_09_213045: true
rhel_09_213050: true
rhel_09_213055: true
rhel_09_213060: true
rhel_09_213065: true
rhel_09_213070: true
rhel_09_213075: true
rhel_09_213080: true
rhel_09_213085: true
rhel_09_213090: true
rhel_09_213095: true
rhel_09_213100: true
rhel_09_213105: true
rhel_09_213110: true
rhel_09_213115: true
rhel_09_214010: true
rhel_09_214030: true
rhel_09_215010: true
rhel_09_215020: true
rhel_09_215025: true
rhel_09_215030: true
rhel_09_215035: true
rhel_09_215040: true
rhel_09_215045: true
rhel_09_215050: true
rhel_09_215055: true
rhel_09_215065: true
rhel_09_215070: true
rhel_09_215075: true
rhel_09_215080: true
rhel_09_215085: true
rhel_09_215090: true
rhel_09_215095: true

rhel_09_231010: true
rhel_09_231015: true
rhel_09_231035: true
rhel_09_231040: true
rhel_09_231045: true
rhel_09_231050: true
rhel_09_231055: true
rhel_09_231060: true
rhel_09_231065: true
rhel_09_231070: true
rhel_09_231075: true
rhel_09_231080: true
rhel_09_231085: true
rhel_09_231090: true
rhel_09_231095: true
rhel_09_231100: true
rhel_09_231105: true
rhel_09_231110: true
rhel_09_231115: true
rhel_09_231120: true
rhel_09_231125: true
rhel_09_231130: true
rhel_09_231135: true
rhel_09_231140: true
rhel_09_231145: true
rhel_09_231150: true
rhel_09_231155: true
rhel_09_231160: true
rhel_09_231165: true
rhel_09_231170: true
rhel_09_231175: true
rhel_09_231180: true
rhel_09_231185: true

rhel_09_231200: true
rhel_09_232010: true
rhel_09_232015: true
rhel_09_232020: true
rhel_09_232025: true
rhel_09_232030: true
rhel_09_232035: true
rhel_09_232040: true
rhel_09_232045: true
rhel_09_232050: true
rhel_09_232055: true
rhel_09_232060: true
rhel_09_232065: true
rhel_09_232070: true
rhel_09_232075: true
rhel_09_232080: true
rhel_09_232085: true
rhel_09_232090: true
rhel_09_232095: true
rhel_09_232100: true
rhel_09_232105: true
rhel_09_232110: true
rhel_09_232115: true
rhel_09_232120: true
rhel_09_232125: true
rhel_09_232130: true
rhel_09_232135: true
rhel_09_232140: true
rhel_09_232145: true
rhel_09_232150: true
rhel_09_232155: true
rhel_09_232160: true
rhel_09_232165: true
rhel_09_232170: true
rhel_09_232175: true
rhel_09_232180: true
rhel_09_232185: true
rhel_09_232190: true
rhel_09_232195: true
rhel_09_232200: true
rhel_09_232205: true
rhel_09_232210: true
rhel_09_232215: true
rhel_09_232220: true
rhel_09_232225: true
rhel_09_232230: true
rhel_09_232235: true
rhel_09_232240: true
rhel_09_232245: true
rhel_09_232250: true
rhel_09_232255: true
rhel_09_232260: true
rhel_09_232265: true
rhel_09_232270: true

rhel_09_251010: true
rhel_09_251015: true
rhel_09_251020: true
rhel_09_251025: true
rhel_09_251030: true
rhel_09_251035: true
rhel_09_251040: true
rhel_09_251045: true
rhel_09_252010: true
rhel_09_252015: true
rhel_09_252020: true
rhel_09_252025: true
rhel_09_252030: true
rhel_09_252035: true
rhel_09_252040: true
rhel_09_252045: true
rhel_09_252050: true
rhel_09_252055: true
rhel_09_252060: true
rhel_09_252065: true
rhel_09_253010: true
rhel_09_253015: true
rhel_09_253020: true
rhel_09_253025: true
rhel_09_253030: true
rhel_09_253035: true
rhel_09_253040: true
rhel_09_253045: true
rhel_09_253050: true
rhel_09_253055: true
rhel_09_253060: true
rhel_09_253065: true
rhel_09_253070: true
rhel_09_253075: true
rhel_09_254010: true
rhel_09_254015: true
rhel_09_254020: true
rhel_09_254025: true
rhel_09_254030: true
rhel_09_254035: true
rhel_09_254040: true
rhel_09_255010: true
rhel_09_255015: true
rhel_09_255020: true
rhel_09_255025: true
rhel_09_255030: true
rhel_09_255035: true
rhel_09_255045: true
rhel_09_255055: true
rhel_09_255060: true
rhel_09_255065: true
rhel_09_255070: true
rhel_09_255075: true
rhel_09_255080: true
rhel_09_255085: true
rhel_09_255090: true
rhel_09_255095: true
rhel_09_255100: true
rhel_09_255110: true
rhel_09_255115: true
rhel_09_255120: true
rhel_09_255125: true
rhel_09_255130: true
rhel_09_255135: true
rhel_09_255140: true
rhel_09_255145: true
rhel_09_255150: true
rhel_09_255155: true
rhel_09_255160: true
rhel_09_255165: true
rhel_09_255175: true
rhel_09_271010: true
rhel_09_271015: true
rhel_09_271020: true
rhel_09_271025: true
rhel_09_271030: true
rhel_09_271035: true
rhel_09_271045: true
rhel_09_271050: true
rhel_09_271055: true
rhel_09_271060: true
rhel_09_271065: true
rhel_09_271070: true
rhel_09_271075: true
rhel_09_271080: true
rhel_09_271085: true
rhel_09_271090: true
rhel_09_271100: true
rhel_09_271105: true
rhel_09_271110: true
rhel_09_271115: true

## Grahical/Gnome interface required
rhel9stig_gui: false

## SSHD
rhel9stig_sshd_config_file: /etc/ssh/sshd_config
rhel9stig_ssh_required: true
rhel9stig_sshd_config:
  banner_file: /etc/issue
  ciphers: "{{ rhel9stig_dod_ciphers }}"
  clientalivecountmax: 1
  clientaliveinterval: 600  # max 600
  compress: no  # yamllint disable-line
  gssapiauth: no  # yamllint disable-line
  hostauth: no  # yamllint disable-line
  ignoreknownhosts: yes  # yamllint disable-line
  ignorerhosts: yes  # yamllint disable-line
  include_conf: /etc/ssh/sshd_config.d/*.conf
  kerbauth: no  # yamllint disable-line
  lastlog: yes  # yamllint disable-line
  loglevel: VERBOSE
  MACs: "{{ rhel9stig_dod_macs }}"
  pubkeyauth: yes  # yamllint disable-line
  permitroot: no  # yamllint disable-line
  privsep: sandbox
  rekeylimit: '1G 1h'
  strictmodes: yes  # yamllint disable-line
  userenv: no  # yamllint disable-line
  x11forward: no  # yamllint disable-line
  x11uselocal: yes  # yamllint disable-line

## Bootloader/Grub settings
rhel9stig_grub_superuser: root
rhel9stig_bootloader_password_hash: 'grub.pbkdf2.sha512.changethispassword'  # pragma: allowlist secret
rhel9stig_set_bootloader_password: false
rhel9stig_grub2_path: /etc/grub2.cfg

## Banner
rhel9stig_logon_banner: "{{ rhel9stig_workaround_for_disa_benchmark | ternary(
        rhel9stig_logon_banner_nice | regex_replace('(?s)(?<!\\n)\\n(?!(\n|$))', ' '),
        rhel9stig_logon_banner_nice) }}"
rhel9stig_logon_banner_nice: |
    You are accessing a U.S. Government (USG) Information System (IS) that is
    provided for USG-authorized use only.

    By using this IS (which includes any device attached to this IS), you consent
    to the following conditions:

    -The USG routinely intercepts and monitors communications on this IS for
    purposes including, but not limited to, penetration testing, COMSEC monitoring,
    network operations and defense, personnel misconduct (PM), law enforcement
    (LE), and counterintelligence (CI) investigations.

    -At any time, the USG may inspect and seize data stored on this IS.

    -Communications using, or data stored on, this IS are not private, are subject
    to routine monitoring, interception, and search, and may be disclosed or used
    for any USG-authorized purpose.

    -This IS includes security measures (e.g., authentication and access controls)
    to protect USG interests--not for your personal benefit or privacy.

    -Notwithstanding the above, using this IS does not constitute consent to PM, LE
    or CI investigative searching or monitoring of the content of privileged
    communications, or work product, related to personal representation or services
    by attorneys, psychotherapists, or clergy, and their assistants. Such
    communications and work product are private and confidential. See User
    Agreement for details.

# Threat Protection
rhel9stig_av_pkg: 'mcafeetp'
rhel9stig_av_service: 'mfetpd'

# Packages and services
rhel9stig_is_ftp_server: false
rhel9stig_is_tftp_server: false
rhel9stig_sendmail_required: false
rhel9stig_nfs_utils_required: false
rhel9stig_ypserv_required: false
rhel9stig_rsh_server_required: false
rhel9stig_telnet_server_required: false
rhel9stig_gssproxy_required: false
rhel9stig_iprutils_required: false
rhel9stig_tuned_required: false
rhel9stig_quagga_required: false

# Sysctl file
rhel9stig_sysctl_file_default: /etc/sysctl.d/99-sysctl.conf

## 23xxxx
rhel9stig_home_filesystem: '/home'

## 25xxxx
## Firewalld
# rhel9stig_custom_firewall_zone is the desired name for the firewall zone
rhel9stig_custom_firewall:
  zone: "drop"
  interface:
  - "{{ ansible_default_ipv4.interface }}"

# rhel9stig_white_list_services is the services that you want to allow through initially for teh new firewall zone
# http and ssh need to be enabled for the role to run.
# This can also be a port number if no service exists
rhelstig_white_list_services:
- sshd

## Interface list allowed to have promiscuous mode set
rhel9stig_promisc_if:
- none

# Set sysctl files
rhel9stig_sysctl_file:
  kernel: "{{ rhel9stig_sysctl_file_default }}"
  network: "{{ rhel9stig_sysctl_file_default }}"

## Chrony
rhel9stig_time_synchronization_servers:
- 0.us.pool.ntp.mil
- 1.us.pool.ntp.mil
rhel9stig_chrony_server_options: "iburst maxpoll 16"  # Max Settings is maxpoll 16

## DNS
# Please adjust accordingly for ipv4 or ipv6
rhel9stig_dns_ip4_servers:
- 8.8.8.8
- 8.8.4.4

# rhel9stig_dns_ip6_servers:
#   - 2001:4860:4860::8888
#   - 2001:4860:4860::8844

## Optional settings Please adjust accordingly for your environment
# rhel9stig_resolv_domains:
# - example.com
# rhel9stig_resolv_search_options: example.com example1.com
# rhel9stig_resolv_dns_options: 'timeout:2 rotate'

## Mail Settings
rhel9stig_postfix_client_conf: permit_mynetworks,reject
